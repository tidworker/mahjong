<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>語音點餐紀錄</title>
</head>
<body>
<div>
  <h1>語音點餐系統</h1>
  <input type="text" id="inputText" placeholder="輸入中文文字或數字" oninput="processInput(this.value)">
  <button onclick="toggleSpeechRecognition()">開始語音輸入</button>
  <button onclick="clearInput()">清除</button>
  <div>點餐輸出：<span id="orderOutput"></span></div>
  <div>總金額：<span id="totalAmount"></span>元</div>
</div>

<ul id="orderList">點餐紀錄:</ul>

<script>
  const menu = {
    '蔥油餅加蛋': 30
  };

  let isListening = false;
  const recognition = new webkitSpeechRecognition();
  recognition.lang = 'zh-Hant-TW';
  recognition.interimResults = false;
  recognition.continuous = false;

  recognition.onresult = function(event) {
    const input = event.results[0][0].transcript;
    document.getElementById('inputText').value = input;
    processInput(input);
  };

  function toggleSpeechRecognition() {
    if (!isListening) {
      recognition.start();
      isListening = true;
    } else {
      recognition.stop();
      isListening = false;
    }
  }

  function clearInput() {
    document.getElementById('inputText').value = '';
    document.getElementById('orderOutput').textContent = '';
    document.getElementById('totalAmount').textContent = '';
    document.getElementById('orderList').innerHTML = '';
  }

  function processInput(input) {
    input = input.trim();
    const orderMatch = input.match(/([蔥油餅加蛋]+)\s*和\s*(\d+)/);

    if (orderMatch) {
      const itemName = orderMatch[1];
      const itemQuantity = parseInt(orderMatch[2]);

      if (menu.hasOwnProperty(itemName)) {
        const itemPrice = menu[itemName];
        const totalPrice = itemPrice * itemQuantity;

        document.getElementById('orderOutput').textContent = `${itemName} x ${itemQuantity}`;
        document.getElementById('totalAmount').textContent = totalPrice;

        updateList('orderList', `${itemName} x ${itemQuantity} - ${totalPrice}元`);
      } else {
        document.getElementById('orderOutput').textContent = '未知的菜單項目';
      }
    } else {
      document.getElementById('orderOutput').textContent = '無效的輸入格式';
    }
  }

  function updateList(listId, text) {
    const ul = document.getElementById(listId);
    const li = document.createElement('li');
    li.textContent = text;
    ul.appendChild(li);
  }
</script>
</body>
</html>